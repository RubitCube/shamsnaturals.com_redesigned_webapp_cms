# ============================================
# Primary Domain .htaccess for Test Server
# Location: Primary domain root (rubitcubedev.com)
# Purpose: Redirect to subdomain (ecobagdealers.rubitcubedev.com)
# ============================================

# === PHP Settings ===
php_flag short_open_tag on
php_flag display_errors off
php_value error_reporting 0

# === Security: Block sensitive files ===
<FilesMatch "(^\.env|composer\.json|composer\.lock|package\.json|yarn\.lock|artisan|server-status|phpinfo\.php|readme\.md|README\.txt|\.git|\.gitignore|\.gitattributes)$">
    Require all denied
</FilesMatch>

# === Block known malicious patterns ===
RewriteEngine On
RewriteCond %{QUERY_STRING} (\.env|wp-config|eval\(|base64_encode|/etc/passwd|/proc/self/environ) [NC]
RewriteRule .* - [F,L]

# === Disable directory browsing ===
Options -Indexes

# === Block bad bots ===
RewriteCond %{HTTP_USER_AGENT} (MJ12bot|AhrefsBot|SemrushBot|crawler|python-requests|curl|scrapy|lwp) [NC]
RewriteRule .* - [F,L]

# === Force HTTPS ===
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# === Redirect primary domain to subdomain ===
# Redirect rubitcubedev.com to ecobagdealers.rubitcubedev.com
RewriteCond %{HTTP_HOST} ^(www\.)?rubitcubedev\.com$ [NC]
RewriteRule ^(.*)$ "https://ecobagdealers.rubitcubedev.com/$1" [R=301,L]

# === Security Headers ===
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# === PHP Handler ===
<IfModule mime_module>
    AddHandler application/x-httpd-ea-php82___lsphp .php .php8 .phtml
</IfModule>

# BEGIN cPanel-generated php ini directives, do not edit
<IfModule php8_module>
    php_flag display_errors Off
    php_value max_execution_time 60
    php_value max_input_time 60
    php_value max_input_vars 1000
    php_value memory_limit 512M
    php_value post_max_size 516M
    php_value session.gc_maxlifetime 1440
    php_value session.save_path "/var/cpanel/php/sessions/ea-php82"
    php_value upload_max_filesize 512M
    php_flag zlib.output_compression On
</IfModule>

<IfModule lsapi_module>
    php_flag display_errors Off
    php_value max_execution_time 60
    php_value max_input_time 60
    php_value max_input_vars 1000
    php_value memory_limit 512M
    php_value post_max_size 516M
    php_value session.gc_maxlifetime 1440
    php_value session.save_path "/var/cpanel/php/sessions/ea-php82"
    php_value upload_max_filesize 512M
    php_flag zlib.output_compression On
</IfModule>
# END cPanel-generated php ini directives, do not edit

# php -- BEGIN cPanel-generated handler, do not edit
<IfModule mime_module>
    AddHandler application/x-httpd-ea-php82___lsphp .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit

